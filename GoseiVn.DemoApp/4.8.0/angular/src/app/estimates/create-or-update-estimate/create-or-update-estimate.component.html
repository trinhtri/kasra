<form autocomplete="off" #createEstimateModal="ngForm" (ngSubmit)="save()">
    <h1 mat-dialog-title>{{ "Create Estimate" | localize }}</h1>
    <mat-dialog-content>
        <div class="row">
            <div class="col-md-6">
                <mat-form-field>
                    <input matInput name="firstName" [placeholder]="'First Name' | localize" required [(ngModel)]="estimateInput.firstname"
                        maxlength="20" />
                </mat-form-field>
            </div>
            <div class="col-md-6">
                <mat-form-field>
                    <input matInput name="lastName" [placeholder]="'Last Name' | localize" required [(ngModel)]="estimateInput.lastName"
                        maxlength="20" />
                </mat-form-field>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <mat-form-field>
                    <input matInput name="mobile" [placeholder]="'Mobile' | localize" required [(ngModel)]="estimateInput.mobile"
                        maxlength="10" />
                </mat-form-field>
            </div>
            <div class="col-md-6">
                <mat-form-field>
                    <input matInput name="email" [placeholder]="'Email' | localize" [(ngModel)]="estimateInput.email"
                        maxlength="25" email />
                </mat-form-field>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <mat-form-field>
                    <input matInput name="addressLine1" [placeholder]="'Address line1' | localize" [(ngModel)]="estimateInput.addressLine1"
                        maxlength="100" />
                </mat-form-field>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <mat-form-field>
                    <input matInput name="addressLine2" [placeholder]="'Address line2' | localize" [(ngModel)]="estimateInput.addressLine2"
                        maxlength="100" />
                </mat-form-field>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <mat-form-field>
                    <input matInput name="city" [placeholder]="'City' | localize" [(ngModel)]="estimateInput.city"
                        maxlength="25" />
                </mat-form-field>
            </div>
            <div class="col-md-4">
                <mat-form-field>
                    <mat-select [placeholder]="l('State')" name="state">
                        <mat-option value="">{{ '- State -' | localize }}</mat-option>
                        <mat-option value="2">2</mat-option>
                        <mat-option value="3">3</mat-option>
                        <mat-option value="4">4</mat-option>
                        <mat-option value="5">5</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-4">
                <mat-form-field>
                    <input matInput name="code" [placeholder]="'Code' | localize" [(ngModel)]="estimateInput.code"
                        maxlength="10" />
                </mat-form-field>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Measurements</div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-2">
                        <mat-form-field>
                            <input type="number" matInput name="width" [placeholder]="'Width' | localize" [(ngModel)]="estimateInput.width"
                                maxlength="12" />
                        </mat-form-field>
                    </div>
                    <div class="col-md-2">
                        <mat-form-field>
                            <input type="number" matInput name="height" [placeholder]="'Height' | localize" [(ngModel)]="estimateInput.height"
                                maxlength="12" />
                        </mat-form-field>
                    </div>
                    <div class="col-md-2">
                        <mat-form-field>
                            <input type="number" matInput name="length" [placeholder]="'Length' | localize" [(ngModel)]="estimateInput.length"
                                maxlength="12" />
                        </mat-form-field>
                    </div>
                    <div class="col-md-2">
                        <mat-form-field>
                            <input type="number" matInput name="numberOfShingles" [placeholder]="'Number of shingles' | localize"
                                [(ngModel)]="estimateInput.noOfShingles" maxlength="12" />
                        </mat-form-field>
                    </div>
                    <div class="col-md-4">
                        <span for="color" style=" float: left; padding-top: 16px; margin-right: 10px; color:#7c7c7c;">Color</span>
                        <input class="form-control" style="width:50px; float:left; margin-top: 4px;" [(colorPicker)]="color"
                            [style.background]="color" id="color" (colorPickerChange)="colorChanged($event)" />
                    </div>
                </div>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Upload images</div>
            <div class="panel-body">
                <div class="col-md-3">
                    <div class="inline-block">
                        <div ngfDrop multiple="1" selectable="1" [(validDrag)]="validComboDrag" [(files)]="files"
                            accept="image/*" [maxSize]="maxSize" [(lastInvalids)]="lastInvalids" [(dragFiles)]="dragFiles"
                            class="well my-drop-zone" [class.invalid-drag]="validComboDrag===false" [class.valid-drag]="validComboDrag"
                            (filesChange)="lastFileAt=getDate()" [fileDropDisabled]="fileDropDisabled">
                            <i class="fa fa-paperclip" aria-hidden="true"></i><br>
                            Add file or drop here
                        </div>
                    </div>
                </div>
                <div class="col-md-9" style="overflow-x:auto">
                    <table class="table" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Name</th>
                                <!-- <th>Type</th> -->
                                <th>Size</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of files;let i=index">
                                <td>
                                    <div *ngIf="['image/gif','image/png','image/jpeg'].indexOf(item.type)>=0">
                                        <div class="previewIcon" [ngfBackground]="item"></div>
                                    </div>
                                </td>
                                <td><strong>{{ item.name }}</strong></td>
                                <!-- <td nowrap>
                                  {{ item.type }}
                                </td> -->
                                <td nowrap>
                                    {{ item.size/1024/1024 | number:'.2' }} MB
                                </td>
                                <td nowrap>
                                    <button type="button" class="btn btn-danger btn-xs" (click)="files.splice(i,1)">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="form-group col-md-12">
                <mat-form-field>
                    <textarea matInput name="note" [placeholder]="'Note' | localize" [(ngModel)]="estimateInput.importantNote"
                        maxlength="100"></textarea>
                </mat-form-field>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Invoice</div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-4">
                        <mat-form-field>
                            <input type="number" matInput name="workHour" [placeholder]="'Work hours' | localize"
                                [(ngModel)]="estimateInput.workHours" pattern="[0-9]+([\.,][0-9]+)?" maxlength="6" />
                        </mat-form-field>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field>
                            <input type="number" matInput name="rate" [placeholder]="'Rate (USD/ hour)' | localize"
                                [(ngModel)]="estimateInput.rate" maxlength="12" />
                        </mat-form-field>
                    </div>
                    <div class="col-md-4">
                        <mat-form-field>
                            <input type="number" matInput name="totalAmount" [placeholder]="'Total amount ($)' | localize"
                                [(ngModel)]="estimateInput.totalAmount" maxlength="12" />
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

    </mat-dialog-content>
    <div mat-dialog-actions align="end">
        <button mat-button type="button" [disabled]="saving" (click)="close(false)">
            {{ "Cancel" | localize }}
        </button>
        <button mat-flat-button type="submit" flex="15" color="primary" [disabled]="!createEstimateModal.form.valid || saving">
            {{ "Save" | localize }}
        </button>
    </div>
</form>